<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>AI Scan Adventure</title>
    <style>
        body { background: #111; color: white; font-family: sans-serif; text-align: center; }
        #msg { height: 100px; padding: 20px; font-size: 1.2rem; background: #222; margin: 10px auto; max-width: 600px; border-radius: 10px; display: flex; align-items: center; justify-content: center; }
        .stat-container { display: flex; justify-content: center; gap: 20px; margin: 20px; }
        .stat-box { background: #333; padding: 15px; border-radius: 10px; width: 200px; }
        .btn-group { display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; max-width: 600px; margin: auto; }
        button { padding: 15px 25px; font-size: 1rem; cursor: pointer; border: none; border-radius: 5px; background: #444; color: white; }
        button:hover { background: #555; }
        .item-list { display: none; background: #222; padding: 20px; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); border: 2px solid #555; max-height: 80vh; overflow-y: auto; width: 80%; }
        .rare-legend { color: #ffd700; font-weight: bold; }
        .rare-elite { color: #00f2ff; font-weight: bold; }
    </style>
</head>
<body>

    <div id="msg">ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦ãã ã•ã„</div>

    <div class="stat-container">
        <div class="stat-box">
            <h3>Player <span id="p-pelem">ğŸ”¥</span></h3>
            <p>HP: <span id="p-php">500</span> / <span id="p-pmax">500</span></p>
            <p>ATK: <span id="p-patk">100</span> | DEF: <span id="p-pdef">50</span></p>
        </div>
        <div class="stat-box">
            <h3>Enemy <span id="e-eelem">---</span></h3>
            <p id="e-name">???</p>
            <p>HP: <span id="e-ehp">---</span></p>
        </div>
    </div>

    <div class="btn-group">
        <button onclick="scanMonster()">ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚¹ã‚­ãƒ£ãƒ³</button>
        <button onclick="scanWeapon()">æ­¦å™¨ã‚¹ã‚­ãƒ£ãƒ³</button>
        <button onclick="playerAttack()" id="atk-btn" disabled>æ”»æ’ƒ</button>
        <button onclick="toggleItems()" id="item-btn" disabled>ã‚¢ã‚¤ãƒ†ãƒ </button>
    </div>

    <div id="item-window" class="item-list">
        <h3>æ‰€æŒã‚¢ã‚¤ãƒ†ãƒ </h3>
        <div id="items-container"></div>
        <button onclick="toggleItems()" style="margin-top:20px;">é–‰ã˜ã‚‹</button>
    </div>

<script>
// --- ã‚²ãƒ¼ãƒ å¤‰æ•° ---
let php = 500, pmax = 500, patk = 100, pdef = 50, pelem = "ğŸ”¥";
let ehp = 0, emax = 0, eatk = 0, eelem = "ğŸŒ¿", ename = "";
let inventory = [200, 274, 299]; // åˆæœŸã‚¢ã‚¤ãƒ†ãƒ 
let fieldEffect = null, fieldTimer = 0, trapTimer = 0;
const ELEMENTS = { "ğŸ”¥": "ğŸŒ¿", "ğŸ’§": "ğŸ”¥", "âš¡": "ğŸ’§", "ğŸŒ¿": "âš¡" };

// --- 100ç¨®é¡ã®ã‚¢ã‚¤ãƒ†ãƒ DB (ä»£è¡¨çš„ãªã‚‚ã®ã‚’æŠœç²‹ã€æ§‹é€ ã¯å…¨ç¨®å…±é€š) ---
const DB_ITEM = {
    200: { name: "éå¸¸é£Ÿ", rare: "NORMAL", type: "heal", val: 50 },
    210: { name: "ãƒãƒ¼ã‚·ãƒ§ãƒ³", rare: "ELITE", type: "heal", val: 600 },
    216: { name: "ã‚¨ãƒªã‚¯ã‚µãƒ¼", rare: "LEGEND", type: "heal_per", val: 1.0 },
    220: { name: "ç«ã®ç²‰", rare: "NORMAL", type: "dmg", elem: "ğŸ”¥", val: 50 },
    224: { name: "å¤ªé™½ã®è¼ã", rare: "LEGEND", type: "dmg", elem: "ğŸ”¥", val: 1200 },
    260: { name: "ç…™ç‰", rare: "NORMAL", type: "escape" },
    265: { name: "ä¸æ€è­°ãªç ‚æ™‚è¨ˆ", rare: "LEGEND", type: "extra" },
    269: { name: "è™¹ã®ã‹ã‘ã‚‰", rare: "LEGEND", type: "auto_weak" },
    270: { name: "ç™ºç«ç‡ƒæ–™", rare: "ELITE", type: "field", elem: "ğŸ”¥" },
    271: { name: "é›¨é›²ç™ºç”Ÿæ©Ÿ", rare: "ELITE", type: "field", elem: "ğŸ’§" },
    272: { name: "ç£å ´ç™ºç”Ÿè£…ç½®", rare: "ELITE", type: "field", elem: "âš¡" },
    273: { name: "è¶…æˆé•·ä¿ƒé€²å‰¤", rare: "ELITE", type: "field", elem: "ğŸŒ¿" },
    274: { name: "æ¯’é‡", rare: "NORMAL", type: "inst_death", rate: 0.1 },
    275: { name: "ã‚®ãƒ£ãƒ³ãƒ–ãƒ«ã®ã‚µã‚¤ã‚³ãƒ­", rare: "ELITE", type: "gamble" },
    276: { name: "ãƒšãƒ³ã‚­", rare: "NORMAL", type: "paint" },
    277: { name: "è¦šæ‚Ÿã®ã‚¹ã‚¹ãƒ¡", rare: "ELITE", type: "atk_focus" },
    278: { name: "äº€ã®ç”²ç¾…", rare: "ELITE", type: "def_focus" },
    279: { name: "ç½ ", rare: "NORMAL", type: "trap" },
    280: { name: "å¤ã³ãŸãƒ©ãƒ³ãƒ—", rare: "LEGEND", type: "none" },
    291: { name: "æ¼¢ã®æµªæ¼«", rare: "LEGEND", type: "none" },
    298: { name: "çŸ³", rare: "NORMAL", type: "stone" },
    299: { name: "è–æ›¸", rare: "LEGEND", type: "bible" }
};
// (â€»200-297ã®å…¨ãƒ‡ãƒ¼ã‚¿ãŒåŒæ§˜ã®å½¢å¼ã§ã“ã“ã«å…¥ã‚Šã¾ã™)

// --- ãƒãƒˆãƒ«ãƒ­ã‚¸ãƒƒã‚¯ ---
function updateUI() {
    document.getElementById('p-php').innerText = php;
    document.getElementById('p-pmax').innerText = pmax;
    document.getElementById('p-patk').innerText = patk;
    document.getElementById('p-pdef').innerText = pdef;
    document.getElementById('p-pelem').innerText = pelem;
    document.getElementById('e-ehp').innerText = ehp > 0 ? ehp : "---";
    document.getElementById('e-eelem').innerText = eelem;
    document.getElementById('e-name').innerText = ename || "???";
}

function scanMonster() {
    ename = "AIãŒè¦‹ã¤ã‘ãŸãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼";
    ehp = 300; emax = 300; eatk = 40; eelem = "ğŸŒ¿";
    document.getElementById('msg').innerText = ename + " ãŒç¾ã‚ŒãŸï¼";
    document.getElementById('atk-btn').disabled = false;
    document.getElementById('item-btn').disabled = false;
    updateUI();
}

function scanWeapon() {
    patk += 20;
    document.getElementById('msg').innerText = "æ­¦å™¨ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ãŸï¼æ”»æ’ƒåŠ›ãŒä¸ŠãŒã£ãŸï¼";
    updateUI();
}

function playerAttack() {
    let dmg = patk;
    if (ELEMENTS[pelem] === eelem) dmg = Math.floor(dmg * 1.5);
    ehp -= dmg;
    document.getElementById('msg').innerText = "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ”»æ’ƒï¼ " + dmg + " ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼";
    updateUI();
    if (ehp <= 0) setTimeout(winBattle, 1000);
    else setTimeout(enemyTurn, 1000);
}

function enemyTurn() {
    if (trapTimer > 0) {
        trapTimer--;
        if (Math.random() < 0.4) {
            document.getElementById('msg').innerText = "æ•µã¯ç½ ã«ã‹ã‹ã£ã¦å‹•ã‘ãªã„ï¼";
            return;
        }
    }
    let dmg = Math.max(5, eatk - pdef);
    php -= dmg;
    document.getElementById('msg').innerText = ename + " ã®æ”»æ’ƒï¼ " + dmg + " ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼";
    updateUI();
    if (php <= 0) alert("æ•—åŒ—ã—ã¾ã—ãŸ...");
}

function winBattle() {
    document.getElementById('msg').innerText = "å‹åˆ©ï¼å ±é…¬ã‚¢ã‚¤ãƒ†ãƒ ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¾ã™...";
    const rewardId = 200 + Math.floor(Math.random() * 100);
    inventory.push(rewardId);
    alert(DB_ITEM[rewardId].name + " ã‚’æ‰‹ã«å…¥ã‚ŒãŸï¼");
    // åˆæœŸçŠ¶æ…‹ã«æˆ»ã™
    ehp = 0; ename = "";
    document.getElementById('atk-btn').disabled = true;
    updateUI();
}

// --- ã‚¢ã‚¤ãƒ†ãƒ ä½¿ç”¨ã‚·ã‚¹ãƒ†ãƒ  ---
function toggleItems() {
    const win = document.getElementById('item-window');
    win.style.display = win.style.display === 'block' ? 'none' : 'block';
    if (win.style.display === 'block') {
        const container = document.getElementById('items-container');
        container.innerHTML = "";
        inventory.forEach((id, index) => {
            const it = DB_ITEM[id];
            const b = document.createElement('button');
            b.style.margin = "5px";
            b.className = it.rare === "LEGEND" ? "rare-legend" : (it.rare === "ELITE" ? "rare-elite" : "");
            b.innerText = it.name;
            b.onclick = () => useItem(id, index);
            container.appendChild(b);
        });
    }
}

function useItem(id, index) {
    const it = DB_ITEM[id];
    let m = it.name + " ã‚’ä½¿ç”¨ï¼ ";

    if (it.type === "heal") php = Math.min(pmax, php + it.val);
    else if (it.type === "heal_per") php = pmax;
    else if (it.type === "inst_death") {
        if (Math.random() < it.rate) { ehp = 0; m += "æ•µã‚’å³æ­»ã•ã›ãŸï¼"; }
        else m += "åŠ¹æœãŒãªã‹ã£ãŸ...";
    }
    else if (it.type === "bible") { php = pmax; ehp = 1; m += "å¥‡è·¡ãŒèµ·ããŸï¼"; }
    else if (it.type === "none") m += "ã—ã‹ã—ä½•ã‚‚èµ·ããªã‹ã£ãŸã€‚";
    
    document.getElementById('msg').innerText = m;
    inventory.splice(index, 1);
    toggleItems();
    updateUI();
    if (ehp <= 0) setTimeout(winBattle, 1000);
    else setTimeout(enemyTurn, 1000);
}
</script>
</body>
</html>
